# Railway Configuration pour Lym (Presence)
# Déploiement automatique avec migrations Prisma

[build]
builder = "nixpacks"
buildCommand = "npm ci && npx prisma generate && npm run build"

[deploy]
# Option A: Migrations au démarrage (recommandé)
startCommand = "npx prisma migrate deploy && npm start"
healthcheckPath = "/api/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3

[environments.production]
# Railway injecte automatiquement DATABASE_URL si Postgres est linké
# Ajouter ces variables manuellement dans le dashboard Railway:
# - NEXTAUTH_SECRET
# - NEXTAUTH_URL (ton domaine Railway)
# - OPENAI_API_KEY (si utilisé)
